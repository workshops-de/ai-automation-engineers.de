---
import BaseLayout from '../layouts/BaseLayout.astro';

const title = 'Home';
const description = 'Die Community für KI-Automatisierungsingenieure. Vernetze dich mit Experten und gestalte die Zukunft intelligenter Automatisierung.';

// Load latest blog posts
const modules = import.meta.glob('./blog/*/index.md', { eager: true });
const allPosts = Object.entries(modules).map(([path, module]) => {
  const mod = module as any;
  return {
    frontmatter: mod.frontmatter || {},
    url: path.replace('./blog/', '/blog/').replace('/index.md', '/')
  };
});

// Process and sort blog posts  
const blogPosts = allPosts.filter(post => {
  const frontmatter = post.frontmatter || {};
  const url = post.url;
  
  const folderMatch = url?.match(/\/(\d{4}-\d{2}-\d{2})-/);
  const dateFromFolder = folderMatch ? folderMatch[1] : null;
  const publishDate = frontmatter.pubDate || frontmatter.publishDate || dateFromFolder;
  
  return !!publishDate;
}).map(post => {
  const frontmatter = post.frontmatter || {};
  const url = post.url;
  
  const folderMatch = url?.match(/\/(\d{4}-\d{2}-\d{2})-/);
  const dateFromFolder = folderMatch ? folderMatch[1] : null;
  const publishDate = frontmatter.pubDate || frontmatter.publishDate || dateFromFolder;
  
  return {
    title: frontmatter.title || 'Ohne Titel',
    excerpt: frontmatter.description || 'Keine Beschreibung verfügbar',
    publishDate: publishDate!,
    readTime: frontmatter.readTime || '5 min Lesezeit',
    category: frontmatter.category || 'Allgemein',
    author: frontmatter.author || 'Anonym',
    image: frontmatter.image || '/og-image.jpg',
    tags: frontmatter.tags || [],
    url: url
  };
}).sort((a, b) => {
  return new Date(b.publishDate).getTime() - new Date(a.publishDate).getTime();
}).slice(0, 3); // Get only the latest 3 posts
---

<BaseLayout {title} {description}>
  <!-- Hero Section -->
  <section class="relative min-h-screen bg-white overflow-hidden">
    <!-- Background Animation/Video -->
    <div class="absolute inset-0 bg-gradient-to-br from-blue-50 via-white to-purple-50">
      <div class="absolute inset-0 bg-grid-slate-100 [mask-image:linear-gradient(0deg,white,rgba(255,255,255,0.6))]"></div>
      <!-- Floating animation elements -->
      <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-blue-100 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"></div>
      <div class="absolute top-1/3 right-1/4 w-72 h-72 bg-purple-100 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"></div>
      <div class="absolute bottom-1/4 left-1/3 w-80 h-80 bg-pink-100 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"></div>
    </div>

    <div class="relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pt-32 pb-20">
      <div class="text-center">
        <!-- Main Headline - Very Large Typography -->
        <h1 class="text-6xl sm:text-7xl lg:text-8xl xl:text-9xl font-bold tracking-tight mb-8 animate-fade-in">
          <span class="block text-gray-900">Deine</span>
          <span class="block bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
            <span id="typewriter-text">AI Engineering</span><span id="typewriter-cursor" class="typewriter-cursor">_</span>
          </span>
          <span class="block text-gray-900">Community.</span>
        </h1>
        
        <!-- Subtitle -->
        <p class="text-xl sm:text-2xl lg:text-3xl text-gray-600 mb-16 max-w-4xl mx-auto font-light leading-relaxed animate-fade-in animation-delay-300">
          Verbinde dich mit KI-Automatisierungsingenieuren.<br>
          Lerne. Teile. Wachse.
        </p>

        <!-- CTA Buttons -->
        <div class="flex flex-col sm:flex-row gap-6 justify-center items-center animate-fade-in animation-delay-600">
          <a href="/profiles" 
             class="inline-flex items-center px-8 py-4 text-lg font-semibold text-white bg-gray-900 rounded-full hover:bg-gray-800 transition-all duration-300 shadow-lg hover:shadow-xl">
            Profile entdecken
            <svg class="ml-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
          <a href="/blog" 
             class="inline-flex items-center px-8 py-4 text-lg font-semibold text-gray-900 bg-white border-2 border-gray-200 rounded-full hover:border-gray-900 transition-all duration-300">
            Insights lesen
          </a>
        </div>
      </div>
    </div>

    <!-- Scroll indicator -->
    <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce">
      <div class="w-6 h-10 border-2 border-gray-400 rounded-full flex justify-center">
        <div class="w-1 h-3 bg-gray-400 rounded-full mt-2 animate-pulse"></div>
      </div>
    </div>
  </section>

  <!-- Stats Section -->
  <section class="py-32 bg-white">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-16 text-center">
        <div class="animate-fade-in-up">
          <div class="text-5xl font-bold text-gray-900 mb-4">500+</div>
          <div class="text-xl text-gray-600">Experten</div>
        </div>
        <div class="animate-fade-in-up animation-delay-200">
          <div class="text-5xl font-bold text-gray-900 mb-4">50+</div>
          <div class="text-xl text-gray-600">Unternehmen</div>
        </div>
        <div class="animate-fade-in-up animation-delay-400">
          <div class="text-5xl font-bold text-gray-900 mb-4">1000+</div>
          <div class="text-xl text-gray-600">Projekte</div>
        </div>
      </div>
    </div>
  </section>

  <!-- What We Do -->
  <section class="py-32 bg-gray-50">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-20">
        <h2 class="text-5xl sm:text-6xl font-bold text-gray-900 mb-8">
          Wie wir arbeiten.
        </h2>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
          Eine Community, die KI-Automatisierung voranbringt durch Zusammenarbeit, Wissensaustausch und Innovation.
        </p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-20">
        <div class="space-y-16">
          <div class="animate-fade-in-up">
            <h3 class="text-3xl font-bold text-gray-900 mb-6">Experten vernetzen</h3>
            <p class="text-lg text-gray-600 leading-relaxed">
              Verbinde dich mit führenden KI-Automatisierungsexperten aus aller Welt. Tausche Erfahrungen aus und lerne von den Besten der Branche.
            </p>
          </div>
          <div class="animate-fade-in-up animation-delay-200">
            <h3 class="text-3xl font-bold text-gray-900 mb-6">Wissen teilen</h3>
            <p class="text-lg text-gray-600 leading-relaxed">
              Profitiere von kurierten Inhalten, praktischen Tutorials und Einblicken in aktuelle Trends der KI-Automatisierung.
            </p>
          </div>
        </div>
        <div class="space-y-16">
          <div class="animate-fade-in-up animation-delay-300">
            <h3 class="text-3xl font-bold text-gray-900 mb-6">Projekte realisieren</h3>
            <p class="text-lg text-gray-600 leading-relaxed">
              Arbeite gemeinsam an innovativen Automatisierungsprojekten und bringe deine Ideen in reale Lösungen um.
            </p>
          </div>
          <div class="animate-fade-in-up animation-delay-400">
            <h3 class="text-3xl font-bold text-gray-900 mb-6">Zukunft gestalten</h3>
            <p class="text-lg text-gray-600 leading-relaxed">
              Sei Teil einer Bewegung, die die Zukunft der Arbeit durch intelligente Automatisierung neu definiert.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Latest Insights -->
  {blogPosts.length > 0 && (
  <section class="py-32 bg-white">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-20">
        <h2 class="text-5xl sm:text-6xl font-bold text-gray-900 mb-8">
          Neueste Insights.
        </h2>
        <p class="text-xl text-gray-600">
          Entdecke die neuesten Trends und Best Practices in der KI-Automatisierung.
        </p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        {blogPosts.map((post, index) => (
          <article class="group animate-fade-in-up" style={`animation-delay: ${index * 200}ms`}>
            <a href={post.url} class="block">
              <div class="aspect-[4/3] bg-gray-100 rounded-2xl overflow-hidden mb-6 group-hover:scale-105 transition-transform duration-300">
                <img 
                  src={post.image} 
                  alt={post.title}
                  class="w-full h-full object-cover"
                  loading="lazy"
                />
              </div>
              <div class="space-y-3">
                <div class="text-sm text-gray-500 uppercase tracking-wide font-medium">
                  {post.category}
                </div>
                <h3 class="text-2xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors">
                  {post.title}
                </h3>
                <p class="text-gray-600 leading-relaxed">
                  {post.excerpt}
                </p>
                <div class="flex items-center text-sm text-gray-500">
                  <span>{post.author}</span>
                  <span class="mx-2">•</span>
                  <span>{post.readTime}</span>
                </div>
              </div>
            </a>
          </article>
        ))}
      </div>

      <div class="text-center mt-16">
        <a href="/blog" 
           class="inline-flex items-center px-8 py-4 text-lg font-semibold text-gray-900 bg-white border-2 border-gray-200 rounded-full hover:border-gray-900 transition-all duration-300">
          Alle Artikel
          <svg class="ml-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </a>
      </div>
    </div>
  </section>
  )}

  <!-- Final CTA -->
  <section class="py-32 bg-gray-900 text-white">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-5xl sm:text-6xl font-bold mb-8">
        Bereit für die Zukunft?
      </h2>
      <p class="text-xl text-gray-300 mb-12 max-w-3xl mx-auto">
        Werde Teil einer Community, die die Grenzen der KI-Automatisierung neu definiert.
      </p>
      <a href="/profiles" 
         class="inline-flex items-center px-12 py-6 text-xl font-semibold text-gray-900 bg-white rounded-full hover:bg-gray-100 transition-all duration-300 shadow-lg hover:shadow-xl">
        Community beitreten
        <svg class="ml-3 w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
        </svg>
      </a>
    </div>
  </section>
</BaseLayout>

<style>
  .typewriter-cursor {
    animation: blink 1s infinite;
    font-weight: normal;
  }
  
  @keyframes blink {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0; }
  }
</style>

<script>
  // Typewriter effect
  document.addEventListener('DOMContentLoaded', function() {
    const words = [
      'AI Engineering',
      'KI-Nerds',
      'boa boa boa',
      'Prompt Flüsterer'
    ];
    
    let currentWordIndex = 0;
    let currentCharIndex = 0;
    let isDeleting = false;
    const typewriterElement = document.getElementById('typewriter-text');
    const cursorElement = document.getElementById('typewriter-cursor');
    
    if (!typewriterElement || !cursorElement) return;

    function typeWriter() {
      if (!typewriterElement) return;
      
      const currentWord = words[currentWordIndex];
      
      if (isDeleting) {
        // Deleting characters
        typewriterElement.textContent = currentWord.substring(0, currentCharIndex - 1);
        currentCharIndex--;
        
        if (currentCharIndex === 0) {
          isDeleting = false;
          currentWordIndex = (currentWordIndex + 1) % words.length;
          setTimeout(typeWriter, 500); // Pause before typing new word
          return;
        }
        
        setTimeout(typeWriter, 50); // Faster deletion
      } else {
        // Adding characters
        typewriterElement.textContent = currentWord.substring(0, currentCharIndex + 1);
        currentCharIndex++;
        
        if (currentCharIndex === currentWord.length) {
          // Word complete, wait then start deleting
          setTimeout(() => {
            isDeleting = true;
            typeWriter();
          }, 2000); // Wait 2 seconds before deleting
          return;
        }
        
        setTimeout(typeWriter, 100); // Normal typing speed
      }
    }

    // Start the typewriter effect after a short delay
    setTimeout(() => {
      typeWriter();
    }, 1500);
  });
</script>